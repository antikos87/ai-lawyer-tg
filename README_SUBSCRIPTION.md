# üíé –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫ AI-–Æ—Ä–∏—Å—Ç

–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ —Å –ø—Ä–æ–±–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º –¥–ª—è —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞ AI-–Æ—Ä–∏—Å—Ç.

## üéØ –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã

### üÜì –ü—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø (1 –¥–µ–Ω—å)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 1 –¥–µ–Ω—å
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- **–õ–∏–º–∏—Ç—ã:**
  - 3 –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
  - 2 –¥–æ–∫—É–º–µ–Ω—Ç–∞
  - 1 –∞–Ω–∞–ª–∏–∑

### üíº –ë–∞–∑–æ–≤—ã–π (790‚ÇΩ/–º–µ—Å—è—Ü)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 30 –¥–Ω–µ–π
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** 790‚ÇΩ
- **–õ–∏–º–∏—Ç—ã:**
  - 25 –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π
  - 10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - 5 –∞–Ω–∞–ª–∏–∑–æ–≤

### üèÜ –ü—Ä–µ–º–∏—É–º (1490‚ÇΩ/–º–µ—Å—è—Ü)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 30 –¥–Ω–µ–π
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** 1490‚ÇΩ
- **–õ–∏–º–∏—Ç—ã:**
  - –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
  - 30 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - 15 –∞–Ω–∞–ª–∏–∑–æ–≤
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### üíé –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π (3990‚ÇΩ/–º–µ—Å—è—Ü)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 30 –¥–Ω–µ–π
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** 3990‚ÇΩ
- **–õ–∏–º–∏—Ç—ã:**
  - –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ü—Ä–µ–º–∏—É–º
  - 100 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - 50 –∞–Ω–∞–ª–∏–∑–æ–≤
  - API –¥–æ—Å—Ç—É–ø

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **Supabase Database** - —É—á–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
2. **YooKassa Integration** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
3. **Middleware System** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏–π
4. **Webhook Handler** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```sql
-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
users                 -- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram
subscriptions         -- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
subscription_limits   -- –õ–∏–º–∏—Ç—ã –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º
usage_logs           -- –ñ—É—Ä–Ω–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
payments             -- –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:

```env
# Telegram
TELEGRAM_TOKEN=your_telegram_bot_token

# GigaChat
GIGACHAT_CREDENTIALS=your_gigachat_credentials
GIGACHAT_SCOPE=GIGACHAT_API_PERS

# YooKassa
YOOKASSA_SHOP_ID=your_shop_id
YOOKASSA_SECRET_KEY=your_secret_key

# Supabase
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_anon_key
```

### 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase –∏—Å–ø–æ–ª—å–∑—É—è schema.sql
psql -h your_supabase_host -U postgres -d postgres -f supabase/schema.sql

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
python scripts/init_database.py
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook YooKassa

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ webhook —Å–µ—Ä–≤–µ—Ä
python yookassa/webhook.py

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook URL –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ YooKassa:
# https://your-domain.com/webhook/yookassa
```

## üéõÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/subscription` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π
- `/consult` - –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É)
- `/create` - –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É)
- `/analyze` - –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É)

### –ü—Ä–æ—Ü–µ—Å—Å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏

1. **–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥** - –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π
2. **–ü–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞** - —á–µ—Ä–µ–∑ YooKassa:
   - –í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞
   - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
   - –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –æ–ø–ª–∞—Ç—É
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è —á–µ—Ä–µ–∑ webhook

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º `@subscription_required`:

```python
@subscription_required('consultation', '–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è')
async def process_question(update, context):
    # –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
    # –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –ª–∏–º–∏—Ç–∞—Ö
    pass
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
usage_stats = await supabase_client.get_usage_stats(telegram_id)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
can_use, info = await supabase_client.check_and_log_usage(
    telegram_id, 'consultation'
)
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `usage_logs`:
- –¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (consultation, document, analysis)
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°–≤—è–∑—å —Å –ø–æ–¥–ø–∏—Å–∫–æ–π

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞—Ä–∏—Ñ–æ–≤

–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω –∏ –ª–∏–º–∏—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ `subscription_limits`:

```sql
UPDATE subscription_limits 
SET price_kopecks = 89000  -- 890‚ÇΩ
WHERE subscription_type = 'basic';
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤
- –ü–æ–∫–∞–∑ —Ç–µ–∫—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

### –û—à–∏–±–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ webhook
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **RLS (Row Level Security)** –≤ Supabase
- **–í–∞–ª–∏–¥–∞—Ü–∏—è webhook** –æ—Ç YooKassa
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ
- **–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–æ–∫
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ú–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –¢–µ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
python scripts/init_database.py

# –¢–µ—Å—Ç YooKassa
python -c "from yookassa.client import yookassa_client; print('OK')"

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏
python main.py
```

### –õ–æ–≥–∏

–û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- –ö–æ–Ω—Å–æ–ª—å (—É—Ä–æ–≤–µ–Ω—å INFO)
- –§–∞–π–ª—ã –ª–æ–≥–æ–≤ (–ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ)
- Supabase —Ñ—É–Ω–∫—Ü–∏–∏ (SQL –ª–æ–≥–∏)

## üéØ Roadmap

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ** –ø–æ–¥–ø–∏—Å–æ–∫
2. **–°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–¥–æ–∫** –∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤  
3. **–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã** —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
4. **API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**
5. **–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **Telegram Stars** –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
- **–°–±–µ—Ä/–¢–∏–Ω—å–∫–æ—Ñ—Ñ** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **CRM —Å–∏—Å—Ç–µ–º—ã** –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ 