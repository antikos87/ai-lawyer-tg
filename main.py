#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
AI-—é—Ä–∏—Å—Ç Telegram Bot
–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
"""

import logging
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, CallbackQueryHandler, MessageHandler, ConversationHandler, filters, ContextTypes
from typing import Dict, Any, List

from config import TELEGRAM_TOKEN
from bot.handlers import (
    consult_command, category_selected, process_question, 
    back_to_categories, cancel_consultation, ConsultationStates,
    main_menu_callback, continue_consultation, process_dialog_message,
    continue_dialog, end_consultation
)

from bot.document_handlers import (
    DocumentStates, create_command, document_type_selected, document_subtype_selected,
    start_data_collection, process_answer, handle_document_review,
    start_document_editing, start_document_supplement, process_document_changes,
    regenerate_document, finalize_document, handle_document_rating,
    back_to_types, back_to_subtypes, cancel_document_creation,
    cancel_custom_answer, cancel_edit, cancel_supplement
)

from bot.analysis_handlers import (
    AnalysisStates, analyze_command, handle_document_upload, handle_analysis_type_selection,
    handle_additional_actions, cancel_analysis
)

from bot.subscription_handlers import (
    SubscriptionStates, subscription_command, activate_trial_subscription,
    initiate_subscription_payment, check_payment_status,
    subscription_handlers, show_upgrade_menu, renew_subscription, cancel_payment,
    show_trial_upgrade_menu
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)


def determine_user_type(status: Dict[str, Any]) -> str:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
    """
    if not status['has_subscription'] and not status['is_trial_used']:
        return "new_user"
    elif not status['has_subscription'] and status['is_trial_used']:
        return "expired_user"
    elif status['has_subscription'] and status['subscription_type'] == 'trial':
        return "trial_user"
    elif status['has_subscription']:
        return "active_user"
    else:
        return "new_user"


def format_usage_stats(stats: Dict[str, Any]) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    """
    if not stats.get('has_subscription'):
        return ""
    
    def format_limit(used: int, limit: int) -> str:
        if limit == -1:
            return f"{used} (–±–µ–∑–ª–∏–º–∏—Ç)"
        else:
            return f"{used}/{limit}"
    
    consultations = stats['consultations']
    documents = stats['documents']
    analysis = stats['analysis']
    
    return (
        f"üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏: {format_limit(consultations['used'], consultations['limit'])}\n"
        f"üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã: {format_limit(documents['used'], documents['limit'])}\n"
        f"üìä –ê–Ω–∞–ª–∏–∑—ã: {format_limit(analysis['used'], analysis['limit'])}"
    )


def get_usage_warnings(stats: Dict[str, Any]) -> List[str]:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ –ª–∏–º–∏—Ç–∞–º
    """
    warnings = []
    
    if not stats.get('has_subscription'):
        return warnings
    
    consultations = stats['consultations']
    documents = stats['documents']
    analysis = stats['analysis']
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç—ã (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 80% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
    if consultations['limit'] != -1 and consultations['used'] >= consultations['limit'] * 0.8:
        warnings.append("üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è")
    if documents['limit'] != -1 and documents['used'] >= documents['limit'] * 0.8:
        warnings.append("üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è")
    if analysis['limit'] != -1 and analysis['used'] >= analysis['limit'] * 0.8:
        warnings.append("üìä –ê–Ω–∞–ª–∏–∑—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è")
    
    return warnings


async def get_personalized_main_menu(telegram_id: int, user_name: str) -> tuple[str, InlineKeyboardMarkup]:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    try:
        from db_client.database import supabase_client
        
        # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
        status = await supabase_client.get_user_subscription_status(telegram_id)
        user_type = determine_user_type(status)
        
        if user_type == "new_user":
            return get_new_user_menu(user_name)
        elif user_type == "trial_user":
            stats = await supabase_client.get_usage_stats(telegram_id)
            return get_trial_user_menu(user_name, status, stats)
        elif user_type == "active_user":
            stats = await supabase_client.get_usage_stats(telegram_id)
            return get_active_user_menu(user_name, status, stats)
        elif user_type == "expired_user":
            return get_expired_user_menu(user_name, status)
        else:
            return get_new_user_menu(user_name)
            
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ–Ω—é –¥–ª—è {telegram_id}: {e}")
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é –ø—Ä–∏ –æ—à–∏–±–∫–µ
        return get_default_menu(user_name)


def get_new_user_menu(user_name: str) -> tuple[str, InlineKeyboardMarkup]:
    """
    –ú–µ–Ω—é –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏, –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω)
    """
    message = (
        f"üèõÔ∏è **AI-–Æ—Ä–∏—Å—Ç** ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∞–≤–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫\n\n"
        f"üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {user_name}!\n\n"
        
        "üéØ **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ë–ï–°–ü–õ–ê–¢–ù–û:**\n"
        "‚Ä¢ 3 —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏\n"
        "‚Ä¢ 2 –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ª—é–±–æ–≥–æ —Ç–∏–ø–∞\n"
        "‚Ä¢ 1 –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞\n"
        "‚Ä¢ –î–æ—Å—Ç—É–ø –Ω–∞ 24 —á–∞—Å–∞\n\n"
        
        "üí° **–ß—Ç–æ —É–º–µ–µ—Ç AI-–Æ—Ä–∏—Å—Ç:**\n"
        "‚úÖ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ 6 –æ—Ç—Ä–∞—Å–ª—è–º –ø—Ä–∞–≤–∞\n"
        "‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ 40+ —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
        "‚úÖ –ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
        "‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ Word, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω–∞–º –†–§\n\n"
        
        "üöÄ **–ù–∞—á–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!**"
    )
    
    keyboard = [
        [InlineKeyboardButton("üÜì –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø", callback_data="activate_trial")],
        [InlineKeyboardButton("üìã –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–∞—Ä–∏—Ñ—ã", callback_data="subscription_menu")],
        [InlineKeyboardButton("‚ÑπÔ∏è –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Å–µ—Ä–≤–∏—Å–µ", callback_data="menu_help")]
    ]
    
    return message, InlineKeyboardMarkup(keyboard)


def get_trial_user_menu(user_name: str, status: Dict[str, Any], stats: Dict[str, Any]) -> tuple[str, InlineKeyboardMarkup]:
    """
    –ú–µ–Ω—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∞–∫—Ç–∏–≤–Ω—ã–º –ø—Ä–æ–±–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º
    """
    expires_at = status['expires_at']
    usage_text = format_usage_stats(stats)
    warnings = get_usage_warnings(stats)
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Ä–µ–º—è –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è
    time_left = expires_at - expires_at.replace(hour=expires_at.hour)  # –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞
    
    message = (
        f"üèõÔ∏è **AI-–Æ—Ä–∏—Å—Ç** ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∞–≤–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫\n\n"
        f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
        
        f"üÜì **–ü—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø –∞–∫—Ç–∏–≤–µ–Ω**\n"
        f"üìÖ –ò—Å—Ç–µ–∫–∞–µ—Ç: {expires_at.strftime('%d.%m.%Y –≤ %H:%M')}\n\n"
        
        f"üìä **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:**\n{usage_text}\n\n"
    )
    
    if warnings:
        message += "‚ö†Ô∏è **–õ–∏–º–∏—Ç—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è:**\n" + "\n".join(f"‚Ä¢ {w}" for w in warnings) + "\n\n"
        message += "üí° **–°–æ–≤–µ—Ç:** –û—Ñ–æ—Ä–º–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É —Å–µ–π—á–∞—Å, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø!\n\n"
    
    message += "üíº **–ß—Ç–æ –ø–æ–ø—Ä–æ–±—É–µ–º —Å–µ–≥–æ–¥–Ω—è?**"
    
    keyboard = [
        [InlineKeyboardButton("üí¨ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", callback_data="menu_consult")],
        [InlineKeyboardButton("üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="menu_create")],
        [InlineKeyboardButton("üìä –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="menu_analyze")],
        [InlineKeyboardButton("‚≠ê –í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ", callback_data="subscription_menu")],
        [InlineKeyboardButton("‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞", callback_data="menu_help")]
    ]
    
    return message, InlineKeyboardMarkup(keyboard)


def get_active_user_menu(user_name: str, status: Dict[str, Any], stats: Dict[str, Any]) -> tuple[str, InlineKeyboardMarkup]:
    """
    –ú–µ–Ω—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∞–∫—Ç–∏–≤–Ω–æ–π –ø–ª–∞—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π
    """
    subscription_type = status['subscription_type']
    expires_at = status['expires_at']
    usage_text = format_usage_stats(stats)
    warnings = get_usage_warnings(stats)
    
    # –ù–∞–∑–≤–∞–Ω–∏—è —Ç–∞—Ä–∏—Ñ–æ–≤
    type_names = {
        'basic': 'üíº –ë–∞–∑–æ–≤—ã–π',
        'premium': 'üèÜ –ü—Ä–µ–º–∏—É–º',
        'corporate': 'üíé –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π'
    }
    
    type_name = type_names.get(subscription_type, subscription_type)
    
    message = (
        f"üèõÔ∏è **AI-–Æ—Ä–∏—Å—Ç** ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∞–≤–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫\n\n"
        f"üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {user_name}!\n\n"
        
        f"üíé **–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞: {type_name}**\n"
        f"üìÖ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {expires_at.strftime('%d.%m.%Y –≤ %H:%M')}\n\n"
        
        f"üìä **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ:**\n{usage_text}\n\n"
    )
    
    if warnings:
        message += "‚ö†Ô∏è **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**\n" + "\n".join(f"‚Ä¢ {w}" for w in warnings) + "\n\n"
        message += "üí° **–°–æ–≤–µ—Ç:** –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞ –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞!\n\n"
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º—è –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    from datetime import datetime
    days_left = (expires_at - datetime.now(expires_at.tzinfo)).days
    
    if days_left <= 3:
        message += f"‚è∞ **–ü–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ {days_left} –¥–Ω.** –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–æ–¥–ª–∏—Ç—å!\n\n"
    
    message += "üíº **–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é —É—Å–ª—É–≥—É:**"
    
    keyboard = [
        [InlineKeyboardButton("üí¨ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", callback_data="menu_consult")],
        [InlineKeyboardButton("üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="menu_create")],
        [InlineKeyboardButton("üìä –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="menu_analyze")],
        [InlineKeyboardButton("üíé –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π", callback_data="subscription_menu")],
        [InlineKeyboardButton("‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞", callback_data="menu_help")]
    ]
    
    return message, InlineKeyboardMarkup(keyboard)


def get_expired_user_menu(user_name: str, status: Dict[str, Any]) -> tuple[str, InlineKeyboardMarkup]:
    """
    –ú–µ–Ω—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∏—Å—Ç–µ–∫—à–µ–π –ø–æ–¥–ø–∏—Å–∫–æ–π
    """
    message = (
        f"üèõÔ∏è **AI-–Æ—Ä–∏—Å—Ç** ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∞–≤–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫\n\n"
        f"üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, {user_name}!\n\n"
        
        "‚ö†Ô∏è **–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–ª–∞**\n\n"
        
        "üí° **–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**\n"
        "üîÑ **–ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø** ‚Äî –≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º\n"
        "üí¨ **–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é** ‚Äî –æ–ø–ª–∞—Ç–∏—Ç—å —Ä–∞–∑–æ–≤–æ\n"
        "üìÑ **–°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç** ‚Äî –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏\n\n"
        
        "üí∞ **–í—ã–≥–æ–¥–Ω–æ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π:**\n"
        "üìä –≠–∫–æ–Ω–æ–º–∏—è –¥–æ 70% –ø—Ä–∏ –º–µ—Å—è—á–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–µ\n"
        "üéØ –õ–∏–º–∏—Ç—ã –Ω–∞ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ\n"
        "‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–ø–ª–∞—Ç"
    )
    
    keyboard = [
        [InlineKeyboardButton("üîÑ –û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É", callback_data="subscription_menu")],
        [InlineKeyboardButton("üí¨ –†–∞–∑–æ–≤–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", callback_data="single_consult")],
        [InlineKeyboardButton("üìÑ –†–∞–∑–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç", callback_data="single_document")],
        [InlineKeyboardButton("‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞", callback_data="menu_help")]
    ]
    
    return message, InlineKeyboardMarkup(keyboard)


def get_default_menu(user_name: str) -> tuple[str, InlineKeyboardMarkup]:
    """
    –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é –Ω–∞ —Å–ª—É—á–∞–π –æ—à–∏–±–æ–∫
    """
    message = (
        f"üèõÔ∏è **AI-–Æ—Ä–∏—Å—Ç** ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∞–≤–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫\n\n"
        f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}!\n\n"
        
        "üéØ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å:**\n"
        "‚Ä¢ 6 –æ—Ç—Ä–∞—Å–ª–µ–π –ø—Ä–∞–≤–∞\n"
        "‚Ä¢ 40+ —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
        "‚Ä¢ –≠–∫—Å–ø–æ—Ä—Ç –≤ Word\n\n"
        
        "üíº **–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é —É—Å–ª—É–≥—É:**"
    )
    
    keyboard = [
        [InlineKeyboardButton("üí¨ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", callback_data="menu_consult")],
        [InlineKeyboardButton("üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="menu_create")],
        [InlineKeyboardButton("üìä –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="menu_analyze")],
        [InlineKeyboardButton("üíé –ü–æ–¥–ø–∏—Å–∫–∞", callback_data="subscription_menu")],
        [InlineKeyboardButton("‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞", callback_data="menu_help")]
    ]
    
    return message, InlineKeyboardMarkup(keyboard)


async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏
    """
    user = update.effective_user
    user_name = user.first_name if user.first_name else "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥—ã /start
    args = context.args
    if args and args[0] == "payment_success":
        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
        payment_success_message = (
            f"üéâ **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ, {user_name}!**\n\n"
            "‚úÖ **–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!**\n\n"
            "–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ü–æ–¥–ø–∏—Å–∫–∞¬ª.\n\n"
            "üöÄ **–ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ AI-–Æ—Ä–∏—Å—Ç!**"
        )
        
        keyboard = [
            [InlineKeyboardButton("üíé –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É", callback_data="subscription_menu")],
            [InlineKeyboardButton("üí¨ –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é", callback_data="menu_consult")],
            [InlineKeyboardButton("üìÑ –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç", callback_data="menu_create")],
            [InlineKeyboardButton("üìä –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="menu_analyze")],
            [InlineKeyboardButton("üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main")]
        ]
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await update.message.reply_text(
            payment_success_message,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
        return
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–µ–Ω—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if user:
        telegram_id = user.id
        message_text, keyboard = await get_personalized_main_menu(telegram_id, user_name)
    else:
        message_text, keyboard = get_default_menu(user_name)
    
    await update.message.reply_text(
        message_text,
        reply_markup=keyboard,
        parse_mode='Markdown'
    )


async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help - –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞
    """
    help_text = (
        "üìö **–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ AI-—é—Ä–∏—Å—Ç—É**\n\n"
        
        "üéØ **–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**\n\n"
        
        "üí¨ **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è**\n"
        "–ü–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –ø—Ä–∞–≤–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç AI-—é—Ä–∏—Å—Ç–∞\n"
        "6 –æ—Ç—Ä–∞—Å–ª–µ–π –ø—Ä–∞–≤–∞: –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ, —É–≥–æ–ª–æ–≤–Ω–æ–µ, —Å–µ–º–µ–π–Ω–æ–µ, —Ç—Ä—É–¥–æ–≤–æ–µ, –∂–∏–ª–∏—â–Ω–æ–µ, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ\n\n"
        
        "üìÑ **–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**\n" 
        "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è 40+ —Ç–∏–ø–æ–≤ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
        "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ Word\n\n"
        
        "üìä **–ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**\n"
        "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∑–∞–∫–æ–Ω—É, –ø–æ–∏—Å–∫ –æ—à–∏–±–æ–∫, –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤\n\n"
        
        "üéõÔ∏è **–ù–∞–≤–∏–≥–∞—Ü–∏—è:**\n"
        "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤ –º–µ–Ω—é –¥–ª—è –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥\n"
        "‚Ä¢ –ö–Ω–æ–ø–∫–∞ '–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é' –≤–µ—Ä–Ω–µ—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é\n"
        "‚Ä¢ –ö–Ω–æ–ø–∫–∞ '–û—Ç–º–µ–Ω–∞' –ø—Ä–µ—Ä–≤–µ—Ç —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ\n\n"
        
        "üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**\n"
        "‚Ä¢ –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö\n"
        "‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤\n"
        "‚Ä¢ –®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞\n\n"
        
        "üìû **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** @AI_support_users"
    )
    
    keyboard = [
        [InlineKeyboardButton("‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await update.message.reply_text(
        help_text,
        reply_markup=reply_markup,
        parse_mode='Markdown'
    )


async def show_detailed_help(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Å–ø—Ä–∞–≤–∫—É —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏
    """
    query = update.callback_query
    await query.answer()
    
    user_name = update.effective_user.first_name if update.effective_user.first_name else "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    help_text = (
        f"üìö **–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ AI-–Æ—Ä–∏—Å—Ç**\n\n"
        f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}! –í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª:\n\n"
        
        "üéØ **–ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?**"
    )
    
    keyboard = [
        [
            InlineKeyboardButton("üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É", callback_data="help_getting_started"),
            InlineKeyboardButton("üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏", callback_data="help_consultations")
        ],
        [
            InlineKeyboardButton("üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="help_documents"),
            InlineKeyboardButton("üìä –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data="help_analysis")
        ],
        [
            InlineKeyboardButton("üí∞ –¢–∞—Ä–∏—Ñ—ã –∏ –æ–ø–ª–∞—Ç–∞", callback_data="help_pricing"),
            InlineKeyboardButton("üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã", callback_data="help_technical")
        ],
        [
            InlineKeyboardButton("üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", callback_data="help_security"),
            InlineKeyboardButton("‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º", callback_data="help_troubleshooting")
        ],
        [
            InlineKeyboardButton("ü§ñ –û —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", callback_data="help_technology"),
            InlineKeyboardButton("üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã", callback_data="help_contacts")
        ],
        [
            InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å–ø—Ä–∞–≤–∫–µ", callback_data="menu_help")
        ]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.message.edit_text(
        help_text,
        reply_markup=reply_markup,
        parse_mode='Markdown'
    )


async def handle_help_section(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ –ø–æ–¥—Ä–æ–±–Ω–æ–π —Å–ø—Ä–∞–≤–∫–∏
    """
    query = update.callback_query
    await query.answer()
    
    section = query.data.replace("help_", "")
    
    # –°–ª–æ–≤–∞—Ä—å —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
    help_sections = {
        "getting_started": {
            "title": "üöÄ **–ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å AI-–Æ—Ä–∏—Å—Ç**",
            "content": (
                "**–ü—Ä–æ—Å—Ç–æ–π —Å—Ç–∞—Ä—Ç –≤ 3 —à–∞–≥–∞:**\n\n"
                
                "**1Ô∏è‚É£ –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥**\n"
                "‚Ä¢ –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´üíé –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π¬ª\n"
                "‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ ¬´üÜì –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥¬ª\n"
                "‚Ä¢ –ü–æ–ª—É—á–∏—Ç–µ 24 —á–∞—Å–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫–∞—Ä—Ç—ã\n\n"
                
                "**2Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é —É—Å–ª—É–≥—É**\n"
                "‚Ä¢ **üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è** ‚Äî –∑–∞–¥–∞–π—Ç–µ –ø—Ä–∞–≤–æ–≤–æ–π –≤–æ–ø—Ä–æ—Å\n"
                "‚Ä¢ **üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã** ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –¥–æ–≥–æ–≤–æ—Ä –∏–ª–∏ –∑–∞—è–≤–ª–µ–Ω–∏–µ\n"
                "‚Ä¢ **üìä –ê–Ω–∞–ª–∏–∑** ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–π –¥–æ–∫—É–º–µ–Ω—Ç\n\n"
                
                "**3Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç**\n"
                "‚Ä¢ –ß–µ—Ä–µ–∑ 30-60 —Å–µ–∫—É–Ω–¥ –ø–æ–ª—É—á–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç\n"
                "‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Word\n"
                "‚Ä¢ –ó–∞–¥–∞–≤–∞–π—Ç–µ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –≤ –¥–∏–∞–ª–æ–≥–µ\n\n"
                
                "üí° **–°–æ–≤–µ—Ç:** –ù–∞—á–Ω–∏—Ç–µ —Å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã!"
            )
        },
        
        "consultations": {
            "title": "üí¨ **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏**",
            "content": (
                "**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é:**\n\n"
                
                "**üìã –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø—Ä–∞–≤–∞:**\n"
                "‚Ä¢ üè† **–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ** ‚Äî –¥–æ–≥–æ–≤–æ—Ä—ã, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ\n"
                "‚Ä¢ ‚öñÔ∏è **–£–≥–æ–ª–æ–≤–Ω–æ–µ** ‚Äî –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏—è, –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, –∑–∞—â–∏—Ç–∞\n"
                "‚Ä¢ üë®‚Äçüë©‚Äçüëß‚Äçüë¶ **–°–µ–º–µ–π–Ω–æ–µ** ‚Äî –±—Ä–∞–∫, —Ä–∞–∑–≤–æ–¥, –∞–ª–∏–º–µ–Ω—Ç—ã\n"
                "‚Ä¢ üíº **–¢—Ä—É–¥–æ–≤–æ–µ** ‚Äî —É–≤–æ–ª—å–Ω–µ–Ω–∏—è, –∑–∞—Ä–ø–ª–∞—Ç–∞, —Å–ø–æ—Ä—ã\n"
                "‚Ä¢ üèòÔ∏è **–ñ–∏–ª–∏—â–Ω–æ–µ** ‚Äî –∞—Ä–µ–Ω–¥–∞, –ñ–ö–•, –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å\n"
                "‚Ä¢ üìã **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ** ‚Äî —à—Ç—Ä–∞—Ñ—ã, –≥–æ—Å—É—Å–ª—É–≥–∏\n\n"
                
                "**‚úçÔ∏è –û–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é –ø–æ–¥—Ä–æ–±–Ω–æ:**\n"
                "‚Ä¢ –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∏ —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ\n"
                "‚Ä¢ –ö–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —É –≤–∞—Å –µ—Å—Ç—å\n"
                "‚Ä¢ –ß—Ç–æ —É–∂–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞–ª–∏\n"
                "‚Ä¢ –ö–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å\n"
                "‚Ä¢ –†–µ–≥–∏–æ–Ω (–∑–∞–∫–æ–Ω—ã –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è)\n\n"
                
                "**üí¨ –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –¥–∏–∞–ª–æ–≥:**\n"
                "‚Ä¢ –ó–∞–¥–∞–≤–∞–π—Ç–µ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã\n"
                "‚Ä¢ –ü—Ä–æ—Å–∏—Ç–µ —Ä–∞–∑—ä—è—Å–Ω–∏—Ç—å —Ç–µ—Ä–º–∏–Ω—ã\n"
                "‚Ä¢ –£—Ç–æ—á–Ω—è–π—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏\n\n"
                
                "‚ö†Ô∏è **–í–∞–∂–Ω–æ:** AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –∂–∏–≤–æ–≥–æ —é—Ä–∏—Å—Ç–∞ –ø—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö —Å–ø–æ—Ä–∞—Ö"
            )
        },
        
        "documents": {
            "title": "üìÑ **–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**",
            "content": (
                "**40+ —Ç–∏–ø–æ–≤ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:**\n\n"
                
                "**üìã –î–æ–≥–æ–≤–æ—Ä—ã:**\n"
                "‚Ä¢ –ê—Ä–µ–Ω–¥—ã –∂–∏–ª—å—è –∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏\n"
                "‚Ä¢ –ö—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ (–∞–≤—Ç–æ, –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å, —Ç–æ–≤–∞—Ä—ã)\n"
                "‚Ä¢ –û–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥ –∏ –ø–æ–¥—Ä—è–¥–∞\n"
                "‚Ä¢ –ó–∞–π–º–∞ –∏ –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è\n\n"
                
                "**‚öñÔ∏è –°—É–¥–µ–±–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**\n"
                "‚Ä¢ –ò—Å–∫–æ–≤—ã–µ –∑–∞—è–≤–ª–µ–Ω–∏—è (–≤–∑—ã—Å–∫–∞–Ω–∏–µ –¥–æ–ª–≥–æ–≤, –∑–∞—â–∏—Ç–∞ –ø—Ä–∞–≤)\n"
                "‚Ä¢ –í–æ–∑—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∏—Å–∫–∏\n"
                "‚Ä¢ –•–æ–¥–∞—Ç–∞–π—Å—Ç–≤–∞ –∏ –∂–∞–ª–æ–±—ã\n\n"
                
                "**üìù –ü—Ä–µ—Ç–µ–Ω–∑–∏–∏ –∏ –∑–∞—è–≤–ª–µ–Ω–∏—è:**\n"
                "‚Ä¢ –î–æ—Å—É–¥–µ–±–Ω—ã–µ –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏\n"
                "‚Ä¢ –ó–∞—è–≤–ª–µ–Ω–∏—è –≤ –≥–æ—Å–æ—Ä–≥–∞–Ω—ã\n"
                "‚Ä¢ –ñ–∞–ª–æ–±—ã –Ω–∞ –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏\n\n"
                
                "**üéØ –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è:**\n"
                "1. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞\n"
                "2. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n"
                "3. –ü–æ–ª—É—á–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç\n"
                "4. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ Word –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\n\n"
                
                "üí° **–°–æ–≤–µ—Ç:** –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º"
            )
        },
        
        "analysis": {
            "title": "üìä **–ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**",
            "content": (
                "**–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:**\n\n"
                
                "**üìÑ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**\n"
                "‚Ä¢ **–î–æ–∫—É–º–µ–Ω—Ç—ã:** PDF, DOC, DOCX (–¥–æ 10 –ú–ë)\n"
                "‚Ä¢ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** JPG, PNG (—Å–∫–∞–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)\n"
                "‚Ä¢ **–¢–µ–∫—Å—Ç:** –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é\n\n"
                
                "**üîç –¢–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∞:**\n"
                "‚Ä¢ **üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ** ‚Äî —Å—É—Ç—å –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞\n"
                "‚Ä¢ **‚öñÔ∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫–æ–Ω—É** ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º—É –ø—Ä–∞–≤—É\n"
                "‚Ä¢ **üîç –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫** ‚Äî —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–µ–¥–æ—á–µ—Ç—ã\n"
                "‚Ä¢ **‚ö†Ô∏è –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤** ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã\n"
                "‚Ä¢ **üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** ‚Äî –∫–∞–∫ —É–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç\n"
                "‚Ä¢ **üìß –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–ø–∏—Å–∫–∏** ‚Äî –¥–µ–ª–æ–≤–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è\n\n"
                
                "**‚è±Ô∏è –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:**\n"
                "‚Ä¢ –ü—Ä–æ—Å—Ç—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: 30-60 —Å–µ–∫—É–Ω–¥\n"
                "‚Ä¢ –°–ª–æ–∂–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: –¥–æ 2 –º–∏–Ω—É—Ç\n"
                "‚Ä¢ –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã: –¥–æ 3 –º–∏–Ω—É—Ç\n\n"
                
                "üí° **–°–æ–≤–µ—Ç:** –î–ª—è –ª—É—á—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ—Ç–∫–∏–µ —Å–∫–∞–Ω—ã –∏–ª–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã"
            )
        },
        
        "pricing": {
            "title": "üí∞ **–¢–∞—Ä–∏—Ñ—ã –∏ –æ–ø–ª–∞—Ç–∞**",
            "content": (
                "**–ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ç–∞—Ä–∏—Ñ–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:**\n\n"
                
                "**üÜì –ü–†–û–ë–ù–´–ô –ü–ï–†–ò–û–î ‚Äî 24 —á–∞—Å–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ**\n"
                "‚Ä¢ 3 –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏\n"
                "‚Ä¢ 2 –¥–æ–∫—É–º–µ–Ω—Ç–∞\n"
                "‚Ä¢ 1 –∞–Ω–∞–ª–∏–∑\n"
                "‚Ä¢ –ë–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫–∞—Ä—Ç—ã\n\n"
                
                "**üíº –ë–ê–ó–û–í–´–ô ‚Äî 790‚ÇΩ/–º–µ—Å—è—Ü**\n"
                "‚Ä¢ 25 –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π\n"
                "‚Ä¢ 10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
                "‚Ä¢ 5 –∞–Ω–∞–ª–∏–∑–æ–≤\n"
                "‚Ä¢ –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞\n\n"
                
                "**üèÜ –ü–†–ï–ú–ò–£–ú ‚Äî 1490‚ÇΩ/–º–µ—Å—è—Ü** ‚≠ê\n"
                "‚Ä¢ **–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏**\n"
                "‚Ä¢ 30 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
                "‚Ä¢ 15 –∞–Ω–∞–ª–∏–∑–æ–≤\n"
                "‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞\n\n"
                
                "**üíé –ö–û–†–ü–û–†–ê–¢–ò–í–ù–´–ô ‚Äî 3990‚ÇΩ/–º–µ—Å—è—Ü**\n"
                "‚Ä¢ **–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏**\n"
                "‚Ä¢ 100 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
                "‚Ä¢ 50 –∞–Ω–∞–ª–∏–∑–æ–≤\n"
                "‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä\n\n"
                
                "**üí≥ –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã:**\n"
                "‚Ä¢ –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã (Visa, MasterCard, –ú–ò–†)\n"
                "‚Ä¢ –°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)\n"
                "‚Ä¢ –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"
                
                    )
        },
        
        "technical": {
            "title": "üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã**",
            "content": (
                "**–†–µ—à–µ–Ω–∏–µ —á–∞—Å—Ç—ã—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:**\n\n"
                
                "**‚è±Ô∏è –î–æ–ª–≥–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ—Ç–≤–µ—Ç:**\n"
                "‚Ä¢ –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: 15-90 —Å–µ–∫—É–Ω–¥\n"
                "‚Ä¢ –ï—Å–ª–∏ –¥–æ–ª—å—à–µ 3 –º–∏–Ω—É—Ç ‚Äî –æ–±–Ω–æ–≤–∏—Ç–µ —á–∞—Ç\n"
                "‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å\n\n"
                
                "**ü§ñ –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:**\n"
                "1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-3 –º–∏–Ω—É—Ç—ã\n"
                "2. –ù–∞–∂–º–∏—Ç–µ ¬´–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é¬ª\n"
                "3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π /start\n"
                "4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É\n\n"
                
                "**üìÑ –ù–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç:**\n"
                "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–¥–æ 10 –ú–ë)\n"
                "‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: PDF, DOC, DOCX, JPG, PNG\n"
                "‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω\n"
                "‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∂–∞—Ç—å —Ñ–∞–π–ª\n\n"
                
                "**üí≥ –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–ø–ª–∞—Ç–æ–π:**\n"
                "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –∫–∞—Ä—Ç—ã\n"
                "‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞—Ä—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–Ω–ª–∞–π–Ω-–ø–ª–∞—Ç–µ–∂–∏\n"
                "‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é –∫–∞—Ä—Ç—É\n"
                "‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å ID –ø–ª–∞—Ç–µ–∂–∞\n\n"
                
                "**üì± –ü—Ä–æ–±–ª–µ–º—ã –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:**\n"
                "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Telegram\n"
                "‚Ä¢ –û–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏\n"
                "‚Ä¢ –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à Telegram\n"
                "‚Ä¢ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ"
            )
        },
        
        "security": {
            "title": "üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å**",
            "content": (
                "**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö:**\n\n"
                
                "**üîí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:**\n"
                "‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç—ã –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö\n"
                "‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏\n"
                "‚Ä¢ –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ù–ï –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º\n"
                "‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–µ—Å—Å–∏–∏\n\n"
                
                "**üîê –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞:**\n"
                "‚Ä¢ –®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö (TLS 1.3)\n"
                "‚Ä¢ –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã –≤ –†–æ—Å—Å–∏–∏\n"
                "‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏\n"
                "‚Ä¢ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 152-–§–ó –æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n\n"
                
                "**ü§ñ –û–±—Ä–∞–±–æ—Ç–∫–∞ AI:**\n"
                "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–æ—Å—Å–∏–π—Å–∫–∞—è –º–æ–¥–µ–ª—å GigaChat\n"
                "‚Ä¢ –î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–§\n"
                "‚Ä¢ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–≤\n"
                "‚Ä¢ –ù–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞—Ä—É–±–µ–∂–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º\n\n"
                
                "**‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**\n"
                "‚Ä¢ –ù–µ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –Ω–æ–º–µ—Ä–∞ –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ –≤ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è—Ö\n"
                "‚Ä¢ –ú–æ–∂–µ—Ç–µ –∑–∞–º–µ–Ω—è—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –Ω–∞ ¬´–ê¬ª –∏ ¬´–ë¬ª\n"
                "‚Ä¢ –î–ª—è –æ—Å–æ–±–æ –≤–∞–∂–Ω—ã—Ö –¥–µ–ª ‚Äî –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Å –∂–∏–≤—ã–º —é—Ä–∏—Å—Ç–æ–º\n"
                "‚Ä¢ –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π —Ç–∞–π–Ω–æ–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—â–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏\n\n"
                
                "**üîç –ê—É–¥–∏—Ç –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å:**\n"
                "‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏\n"
                "‚Ä¢ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º\n"
                "‚Ä¢ –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π\n"
                "‚Ä¢ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
            )
        },
        
        "troubleshooting": {
            "title": "‚ö†Ô∏è **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º**",
            "content": (
                "**–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:**\n\n"
                
                "**üí≥ –°–ø–∏—Å–∞–ª–∏—Å—å –¥–µ–Ω—å–≥–∏, –Ω–æ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞:**\n"
                "1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª ¬´–ü–æ–¥–ø–∏—Å–∫–∞¬ª –≤ –±–æ—Ç–µ\n"
                "2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç (–±–∞–Ω–∫–∏ –º–æ–≥—É—Ç –∑–∞–¥–µ—Ä–∂–∏–≤–∞—Ç—å)\n"
                "3. –ù–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å ID –ø–ª–∞—Ç–µ–∂–∞\n"
                "4. –ü—Ä–∏–ª–æ–∂–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —Å–ø–∏—Å–∞–Ω–∏—è\n"
                "‚ö° –†–µ—à–∞–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤\n\n"
                
                "**ü§ñ AI –¥–∞–µ—Ç –Ω–µ—Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:**\n"
                "‚Ä¢ –ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –≤–æ–ø—Ä–æ—Å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ\n"
                "‚Ä¢ –£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ–≥–∏–æ–Ω\n"
                "‚Ä¢ –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏\n"
                "‚Ä¢ –ó–∞–¥–∞–π—Ç–µ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã\n"
                "‚Ä¢ –ü—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö —Å–ø–æ—Ä–∞—Ö ‚Äî –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∂–∏–≤–æ–º—É —é—Ä–∏—Å—Ç—É\n\n"
                
                "**üìÑ –°–æ–∑–¥–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫–∏:**\n"
                "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n"
                "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é ¬´–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç¬ª\n"
                "‚Ä¢ –ü–æ–ø—Ä–æ—Å–∏—Ç–µ AI –≤–Ω–µ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n"
                "‚Ä¢ –î–ª—è –≤–∞–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ ‚Äî –ø–æ–∫–∞–∂–∏—Ç–µ —é—Ä–∏—Å—Ç—É\n\n"
                
                "**üìä –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ–ø–æ–ª–Ω—ã–π:**\n"
                "‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç —á–∏—Ç–∞–µ–º—ã–π\n"
                "‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞\n"
                "‚Ä¢ –î–ª—è —Å–∫–∞–Ω–æ–≤ ‚Äî —É–ª—É—á—à–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n"
                "‚Ä¢ –ú–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤—Ä—É—á–Ω—É—é\n\n"
                
                "**üîÑ –õ–∏–º–∏—Ç—ã –∏—Å—á–µ—Ä–ø–∞–Ω—ã —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏:**\n"
                "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏\n"
                "‚Ä¢ –£—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ –ª–∏–º–∏—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ –¥–∞—Ç—É –ø—Ä–æ–¥–ª–µ–Ω–∏—è\n"
                "‚Ä¢ –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞\n"
                "‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏\n\n"
                
                "**üìû –ö–æ–≥–¥–∞ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É:**\n"
                "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏ –∏ –æ—à–∏–±–∫–∏\n"
                "‚Ä¢ –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–ø–ª–∞—Ç–æ–π\n"
                "‚Ä¢ –í–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º\n"
                "‚Ä¢ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é\n"
                "‚Ä¢ –õ—é–±—ã–µ –Ω–µ—è—Å–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–±–æ—Ç–µ –±–æ—Ç–∞"
            )
        },
        
        "technology": {
            "title": "ü§ñ **–û —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ AI-–Æ—Ä–∏—Å—Ç**",
            "content": (
                "**–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –ø–æ–º–æ—â–∏:**\n\n"
                
                "**üß† –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç:**\n"
                "‚Ä¢ **–ú–æ–¥–µ–ª—å:** GigaChat –æ—Ç –°–±–µ—Ä–∞\n"
                "‚Ä¢ **–û–±—É—á–µ–Ω–∏–µ:** —Ä–æ—Å—Å–∏–π—Å–∫–æ–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ\n"
                "‚Ä¢ **–Ø–∑—ã–∫–∏:** —Ä—É—Å—Å–∫–∏–π (–æ—Å–Ω–æ–≤–Ω–æ–π)\n"
                "‚Ä¢ **–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –¥–æ 8000 —Ç–æ–∫–µ–Ω–æ–≤\n"
                "‚Ä¢ **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:** —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è\n\n"
                
                "**‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**\n"
                "‚Ä¢ **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:** 15-90 —Å–µ–∫—É–Ω–¥\n"
                "‚Ä¢ **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** 99.5% –≤—Ä–µ–º–µ–Ω–∏\n"
                "‚Ä¢ **–ù–∞–≥—Ä—É–∑–∫–∞:** –¥–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ\n"
                "‚Ä¢ **–°–µ—Ä–≤–µ—Ä—ã:** —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ –†–æ—Å—Å–∏–∏\n\n"
                
                "**üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:**\n"
                "‚Ä¢ **OCR:** —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π\n"
                "‚Ä¢ **–§–æ—Ä–º–∞—Ç—ã:** PDF, DOC, DOCX, JPG, PNG\n"
                "‚Ä¢ **–†–∞–∑–º–µ—Ä:** –¥–æ 10 –ú–ë –Ω–∞ —Ñ–∞–π–ª\n"
                "‚Ä¢ **–¢–æ—á–Ω–æ—Å—Ç—å:** 95%+ –¥–ª—è —á–µ—Ç–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n\n"
                
                "**üîÑ –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**\n"
                "‚Ä¢ –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤\n"
                "‚Ä¢ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\n"
                "‚Ä¢ –î–æ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n"
                "‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤\n\n"
                
                "**üöÄ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:**\n"
                "‚Ä¢ –ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏\n"
                "‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≥–æ—Å—É—Å–ª—É–≥–∞–º–∏\n"
                "‚Ä¢ –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\n"
                "‚Ä¢ API –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤\n"
                "‚Ä¢ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞\n\n"
                
                "**üèÜ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π AI:**\n"
                "‚Ä¢ –ó–Ω–∞–Ω–∏–µ –º–µ—Å—Ç–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞\n"
                "‚Ä¢ –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö —Ä–µ–∞–ª–∏–π\n"
                "‚Ä¢ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–≤\n"
                "‚Ä¢ –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é –†–§"
            )
        },
        
        "contacts": {
            "title": "üìû **–ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞**",
            "content": (
                "**–ú—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å:**\n\n"
                
                "**üí¨ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**\n"
                "‚Ä¢ **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:** –¥–æ 3 —á–∞—Å–æ–≤ (—Ä–∞–±–æ—á–∏–µ –¥–Ω–∏)\n"
                "‚Ä¢ **–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:** –ü–Ω-–ü—Ç 9:00-18:00 (–ú–°–ö)\n"
                "‚Ä¢ **–Ø–∑—ã–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏:** —Ä—É—Å—Å–∫–∏–π\n\n"
                
                "**üéØ –° —á–µ–º –ø–æ–º–æ–≥–∞–µ–º:**\n"
                "‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –æ—à–∏–±–∫–∏\n"
                "‚Ä¢ –í–æ–ø—Ä–æ—Å—ã –ø–æ –æ–ø–ª–∞—Ç–µ\n"
                "‚Ä¢ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º\n"
                "‚Ä¢ –û–±—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–µ —Å –±–æ—Ç–æ–º\n"
                "‚Ä¢ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é\n\n"
                
                "**üìã –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è —É–∫–∞–∂–∏—Ç–µ:**\n"
                "‚Ä¢ –í–∞—à Telegram ID (–º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å —É @userinfobot)\n"
                "‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã\n"
                "‚Ä¢ –°–∫—Ä–∏–Ω—à–æ—Ç—ã –æ—à–∏–±–æ–∫ (–µ—Å–ª–∏ –µ—Å—Ç—å)\n"
                "‚Ä¢ ID –ø–ª–∞—Ç–µ–∂–∞ (–¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤)\n"
                "‚Ä¢ –í—Ä–µ–º—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã\n\n"
                
                "**‚ö° –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏:**\n"
                "‚Ä¢ –°–ø–∏—Å–∞–Ω–∏–µ –±–µ–∑ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏\n"
                "‚Ä¢ –ü–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç—É\n"
                "‚Ä¢ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ —Ä–∞–±–æ—Ç–µ\n\n"
                                
                "**üìà –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å:**\n"
                "‚Ä¢ –û—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π\n"
                "‚Ä¢ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π\n"
                "‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö\n"
                "‚Ä¢ –ò–¥–µ–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é UX"
                
            )
        }
    }
    
    if section in help_sections:
        section_data = help_sections[section]
        
        keyboard = [
            [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Ä–∞–∑–¥–µ–ª–∞–º", callback_data="detailed_help")],
            [InlineKeyboardButton("üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main")]
        ]
        
        # –î–ª—è —Ä–∞–∑–¥–µ–ª–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —Å–≤—è–∑–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
        if section == "contacts":
            keyboard.insert(0, [InlineKeyboardButton("üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É", url="https://t.me/AI_support_users")])
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await query.message.edit_text(
            f"{section_data['title']}\n\n{section_data['content']}",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    else:
        # –ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≥–ª–∞–≤–Ω–æ–º—É –º–µ–Ω—é —Å–ø—Ä–∞–≤–∫–∏
        await show_detailed_help(update, context)


async def main_menu_handler(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
    """
    query = update.callback_query
    await query.answer()
    
    if query.data == "menu_consult":
        # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
        consultation_text = (
            "üí¨ **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è**\n\n"
            "üìã –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç AI-—é—Ä–∏—Å—Ç–∞ –ø–æ –ª—é–±–æ–º—É –ø—Ä–∞–≤–æ–≤–æ–º—É –≤–æ–ø—Ä–æ—Å—É\n\n"
            
            "üéØ **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:**\n"
            "‚Ä¢ –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ –ø—Ä–∞–≤–æ\n"
            "‚Ä¢ –£–≥–æ–ª–æ–≤–Ω–æ–µ –ø—Ä–∞–≤–æ\n"
            "‚Ä¢ –°–µ–º–µ–π–Ω–æ–µ –ø—Ä–∞–≤–æ\n"
            "‚Ä¢ –¢—Ä—É–¥–æ–≤–æ–µ –ø—Ä–∞–≤–æ\n"
            "‚Ä¢ –ñ–∏–ª–∏—â–Ω–æ–µ –ø—Ä–∞–≤–æ\n"
            "‚Ä¢ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∞–≤–æ\n\n"
            
            "üí° **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**\n"
            "‚Ä¢ –û—Ç–≤–µ—Ç—ã —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∑–∞–∫–æ–Ω—ã –†–§\n"
            "‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤\n"
            "‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–∏–∞–ª–æ–≥–∞\n\n"
            
            "–î–ª—è –Ω–∞—á–∞–ª–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:"
        )
        
        keyboard = [
            [InlineKeyboardButton("‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é", callback_data="start_consult")],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main")]
        ]
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await query.message.reply_text(
            consultation_text,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
        
    elif query.data == "menu_create":
        # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        create_text = (
            "üìÑ **–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**\n\n"
            "üìù –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∑–∞ 5 –º–∏–Ω—É—Ç\n\n"
            
            "üìã **–¢–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (40+ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤):**\n"
            "‚Ä¢ –î–æ–≥–æ–≤–æ—Ä—ã (–∞—Ä–µ–Ω–¥—ã, –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏, —É—Å–ª—É–≥)\n"
            "‚Ä¢ –ò—Å–∫–æ–≤—ã–µ –∑–∞—è–≤–ª–µ–Ω–∏—è (—Å–ø–æ—Ä—ã, –≤–∑—ã—Å–∫–∞–Ω–∏—è)\n"
            "‚Ä¢ –î–æ—Å—É–¥–µ–±–Ω—ã–µ –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏\n"
            "‚Ä¢ –°–æ–≥–ª–∞—à–µ–Ω–∏—è –∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏\n"
            "‚Ä¢ –ó–∞—è–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã\n\n"
            
            "‚ö° **–ü—Ä–æ—Ü–µ—Å—Å:**\n"
            "‚Ä¢ –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞\n"
            "‚Ä¢ –û—Ç–≤–µ—Ç—ã –Ω–∞ 5-7 –≤–æ–ø—Ä–æ—Å–æ–≤\n"
            "‚Ä¢ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ò–ò\n"
            "‚Ä¢ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ Word\n\n"
            
            "–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:"
        )
        
        keyboard = [
            [InlineKeyboardButton("‚ñ∂Ô∏è –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç", callback_data="start_create")],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main")]
        ]
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await query.message.reply_text(
            create_text,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
        
    elif query.data == "menu_analyze":
        # –ü–µ—Ä–µ—Ö–æ–¥ –∫ –∞–Ω–∞–ª–∏–∑—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        analyze_text = (
            "üìä **–ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**\n\n"
            "üîç –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –≤–∞—à–∏–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º\n\n"
            
            "üìÑ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**\n"
            "‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç—ã: DOC, DOCX, PDF\n"
            "‚Ä¢ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: JPG, PNG (—Å–∫–∞–Ω—ã)\n"
            "‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10 –ú–ë\n\n"
            
            "üéØ **–¢–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∞:**\n"
            "‚Ä¢ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω—É\n"
            "‚Ä¢ –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –∏ –Ω–µ–¥–æ—á–µ—Ç–æ–≤\n"
            "‚Ä¢ –û—Ü–µ–Ω–∫–∞ –ø—Ä–∞–≤–æ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤\n"
            "‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é\n"
            "‚Ä¢ –ê–Ω–∞–ª–∏–∑ –¥–µ–ª–æ–≤–æ–π –ø–µ—Ä–µ–ø–∏—Å–∫–∏\n\n"
            
            "–î–ª—è –Ω–∞—á–∞–ª–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:"
        )
        
        keyboard = [
            [InlineKeyboardButton("‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑", callback_data="start_analyze")],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main")]
        ]
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await query.message.reply_text(
            analyze_text,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
        
    elif query.data == "menu_help":
        # –°–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞
        help_text_short = (
            "üìö **–ö—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞**\n\n"
            
            "üéØ **–î–æ—Å—Ç—É–ø–Ω—ã–µ —É—Å–ª—É–≥–∏:**\n"
            "‚Ä¢ üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –ø—Ä–∞–≤—É\n"
            "‚Ä¢ üìÑ –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
            "‚Ä¢ üìä –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n\n"
            
            "üéõÔ∏è **–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:**\n"
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω—É–∂–Ω–æ–π —É—Å–ª—É–≥–∏"
        )
        
        keyboard = [
            [InlineKeyboardButton("üìã –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞", callback_data="detailed_help")],
            [InlineKeyboardButton("üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É", url="https://t.me/AI_support_users")],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main")]
        ]
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await query.message.reply_text(
            help_text_short,
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif query.data == "back_to_main" or query.data == "main_menu":
        # –í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π
        user = update.effective_user
        if user:
            telegram_id = user.id
            user_name = user.first_name if user.first_name else "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
            message_text, keyboard = await get_personalized_main_menu(telegram_id, user_name)
        else:
            user_name = "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
            message_text, keyboard = get_default_menu(user_name)
        
        await query.message.reply_text(
            message_text,
            reply_markup=keyboard,
            parse_mode='Markdown'
        )
    
    elif query.data == "notify_analyze":
        # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞
        await query.message.reply_text(
            "üîî **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ!**\n\n"
            "–ú—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–æ–±—â–∏–º –≤–∞–º, –∫–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞.\n\n"
            "üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–¥–µ—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç\n"
            "‚è∞ –û–∂–∏–¥–∞–µ–º—ã–π —Å—Ä–æ–∫: 2-3 –Ω–µ–¥–µ–ª–∏"
        )
    
    elif query.data == "start_analyze":
        # –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        await analyze_command(update, context)
    
    elif query.data == "analyze":
        # –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∏–∑ –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞)
        await analyze_command(update, context)
    
    elif query.data == "detailed_help":
        # –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞
        await show_detailed_help(update, context)
    
    elif query.data == "subscription_menu":
        # –ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ–¥–ø–∏—Å–∫–∞–º
        await subscription_command(update, context)
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ –ø–æ–¥—Ä–æ–±–Ω–æ–π —Å–ø—Ä–∞–≤–∫–∏
    elif query.data.startswith("help_"):
        await handle_help_section(update, context)
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫
    elif query.data in subscription_handlers:
        handler = subscription_handlers[query.data]
        await handler(update, context)
    
    elif query.data.startswith("check_payment_"):
        await check_payment_status(update, context)


def main() -> None:
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
    """
    # –°–æ–∑–¥–∞—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(TELEGRAM_TOKEN).build()
    
    # ConversationHandler –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π
    consultation_handler = ConversationHandler(
        entry_points=[
            CommandHandler('consult', consult_command),
            CallbackQueryHandler(lambda update, context: consult_command(update, context), pattern='^start_consult$')
        ],
        states={
            ConsultationStates.CATEGORY_SELECTION.value: [
                CallbackQueryHandler(category_selected, pattern='^category_'),
                CallbackQueryHandler(back_to_categories, pattern='^back_to_categories$'),
                CallbackQueryHandler(main_menu_callback, pattern='^main_menu$')
            ],
            ConsultationStates.WAITING_QUESTION.value: [
                MessageHandler(filters.TEXT & ~filters.COMMAND, process_question),
                CallbackQueryHandler(back_to_categories, pattern='^back_to_categories$'),
                CallbackQueryHandler(main_menu_callback, pattern='^main_menu$')
            ],
            ConsultationStates.CONSULTATION_DIALOG.value: [
                MessageHandler(filters.TEXT & ~filters.COMMAND, process_dialog_message),
                CallbackQueryHandler(continue_consultation, pattern='^continue_consultation$'),
                CallbackQueryHandler(continue_dialog, pattern='^continue_dialog$'),
                CallbackQueryHandler(end_consultation, pattern='^end_consultation$'),
                CallbackQueryHandler(main_menu_callback, pattern='^main_menu$')
            ]
        },
        fallbacks=[CommandHandler('cancel', cancel_consultation)],
        allow_reentry=True
    )
    
    # ConversationHandler –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    document_conv_handler = ConversationHandler(
        entry_points=[
            CommandHandler("create", create_command),
            CallbackQueryHandler(lambda update, context: create_command(update, context), pattern='^start_create$')
        ],
        states={
            DocumentStates.DOCUMENT_TYPE_SELECTION.value: [
                CallbackQueryHandler(document_type_selected, pattern="^doctype_"),
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ],
            DocumentStates.DOCUMENT_SUBTYPE_SELECTION.value: [
                CallbackQueryHandler(document_subtype_selected, pattern="^docsubtype_"),
                CallbackQueryHandler(back_to_types, pattern="^back_to_types$"),
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ],
            DocumentStates.DATA_COLLECTION.value: [
                CallbackQueryHandler(start_data_collection, pattern="^start_data_collection$"),
                CallbackQueryHandler(process_answer, pattern="^answer_"),
                CallbackQueryHandler(process_answer, pattern="^custom_answer$"),
                CallbackQueryHandler(process_answer, pattern="^prev_question$"),
                CallbackQueryHandler(cancel_custom_answer, pattern="^cancel_custom$"),
                CallbackQueryHandler(back_to_subtypes, pattern="^back_to_subtypes$"),
                MessageHandler(filters.TEXT & ~filters.COMMAND, process_answer),
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ],
            DocumentStates.DOCUMENT_GENERATION.value: [
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ],
            DocumentStates.DOCUMENT_REVIEW.value: [
                CallbackQueryHandler(handle_document_review, pattern="^accept_document$"),
                CallbackQueryHandler(handle_document_review, pattern="^edit_document$"),
                CallbackQueryHandler(handle_document_review, pattern="^supplement_document$"),
                CallbackQueryHandler(handle_document_review, pattern="^regenerate_document$"),
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ],
            DocumentStates.DOCUMENT_EDITING.value: [
                MessageHandler(filters.TEXT & ~filters.COMMAND, process_document_changes),
                CallbackQueryHandler(start_document_editing, pattern="^edit_document$"),
                CallbackQueryHandler(start_document_supplement, pattern="^supplement_document$"),
                CallbackQueryHandler(cancel_edit, pattern="^cancel_edit$"),
                CallbackQueryHandler(cancel_supplement, pattern="^cancel_supplement$"),
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ],
            DocumentStates.DOCUMENT_FINALIZATION.value: [
                CallbackQueryHandler(handle_document_rating, pattern="^rate_"),
                CallbackQueryHandler(handle_document_rating, pattern="^skip_rating$"),
                CallbackQueryHandler(create_command, pattern="^new_document$"),
                CallbackQueryHandler(lambda update, context: analyze_command(update, context), pattern="^analyze$"),
                CallbackQueryHandler(consult_command, pattern="^consultation$"),
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ]
        },
        fallbacks=[
            CommandHandler("start", start_command),
            CallbackQueryHandler(cancel_document_creation, pattern="^cancel_"),
            CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
        ]
    )
    
    # ConversationHandler –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    analysis_conv_handler = ConversationHandler(
        entry_points=[
            CommandHandler("analyze", analyze_command),
            CallbackQueryHandler(lambda update, context: analyze_command(update, context), pattern='^start_analyze$')
        ],
        states={
            AnalysisStates.DOCUMENT_UPLOAD.value: [
                MessageHandler(filters.Document.ALL | filters.PHOTO, handle_document_upload),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^retry_upload$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^back_to_upload$"),
                CallbackQueryHandler(cancel_analysis, pattern="^cancel_analysis$")
            ],
            AnalysisStates.MULTIPLE_IMAGES.value: [
                MessageHandler(filters.PHOTO, handle_document_upload),  # –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^add_more_images$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^process_single_image$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^process_all_images$"),
                CallbackQueryHandler(cancel_analysis, pattern="^cancel_analysis$")
            ],
            AnalysisStates.ANALYSIS_TYPE_SELECTION.value: [
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^analysis_type_"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^start_analysis$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^back_to_analysis_types$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^change_analysis_type$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^back_to_menu$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^retry_upload$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^back_to_upload$"),
                CallbackQueryHandler(cancel_analysis, pattern="^cancel_analysis$")
            ],
            AnalysisStates.TEXT_PROCESSING.value: [
                # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –¥–∞–ª—å—à–µ
            ],
            AnalysisStates.ANALYSIS_PROCESSING.value: [
                # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –¥–∞–ª—å—à–µ
            ],
            AnalysisStates.RESULTS_REVIEW.value: [
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^back_to_analysis_types$"),
                CallbackQueryHandler(handle_analysis_type_selection, pattern="^change_analysis_type$"),
                CallbackQueryHandler(handle_additional_actions, pattern="^upload_new_document$"),
                CallbackQueryHandler(handle_additional_actions, pattern="^finish_analysis$"),
                CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
            ]
        },
        fallbacks=[
            CommandHandler("start", start_command),
            CallbackQueryHandler(cancel_analysis, pattern="^cancel_analysis$"),
            CallbackQueryHandler(main_menu_callback, pattern="^main_menu$")
        ]
    )
    
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    # ConversationHandler –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫
    subscription_conv_handler = ConversationHandler(
        entry_points=[
            CommandHandler('subscription', subscription_command),
            CallbackQueryHandler(subscription_command, pattern='^subscription_menu$')
        ],
        states={
            SubscriptionStates.SUBSCRIPTION_SELECTION.value: [
                CallbackQueryHandler(activate_trial_subscription, pattern='^activate_trial$'),
                CallbackQueryHandler(initiate_subscription_payment, pattern='^subscribe_'),
                CallbackQueryHandler(initiate_subscription_payment, pattern='^upgrade_(basic|premium|corporate)$'),
                CallbackQueryHandler(main_menu_handler, pattern='^main_menu$')
            ],
            SubscriptionStates.PAYMENT_PROCESSING.value: [
                CallbackQueryHandler(check_payment_status, pattern='^check_payment_'),
                CallbackQueryHandler(cancel_payment, pattern='^cancel_payment$'),
                CallbackQueryHandler(main_menu_handler, pattern='^main_menu$')
            ],
            SubscriptionStates.SUBSCRIPTION_MANAGEMENT.value: [
                CallbackQueryHandler(initiate_subscription_payment, pattern='^upgrade_(basic|premium|corporate)$'),
                CallbackQueryHandler(show_upgrade_menu, pattern='^upgrade_menu$'),
                CallbackQueryHandler(show_trial_upgrade_menu, pattern='^trial_upgrade_menu$'),
                CallbackQueryHandler(renew_subscription, pattern='^renew_subscription$'),
                CallbackQueryHandler(main_menu_handler, pattern='^main_menu$')
            ]
        },
        fallbacks=[
            CommandHandler('cancel', main_menu_handler),
            CallbackQueryHandler(main_menu_handler, pattern='^main_menu$')
        ],
        allow_reentry=True
    )

    application.add_handler(CommandHandler('start', start_command))
    application.add_handler(CommandHandler('help', help_command))
    application.add_handler(CommandHandler('subscription', subscription_command))
    application.add_handler(consultation_handler)
    application.add_handler(document_conv_handler)
    application.add_handler(analysis_conv_handler)
    application.add_handler(subscription_conv_handler)
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è callback query –≤–Ω–µ conversations
    application.add_handler(CallbackQueryHandler(main_menu_handler))
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    logger.info("–ó–∞–ø—É—Å–∫ AI-—é—Ä–∏—Å—Ç –±–æ—Ç–∞...")
    application.run_polling(allowed_updates=Update.ALL_TYPES)


if __name__ == '__main__':
    main() 